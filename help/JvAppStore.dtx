##Package: Core
##Status: Incompleted
----------------------------------------------------------------------------------------------------
@@JvAppStore.pas
Summary
  Contains the interface and generic implemention for the storage backend.
<INCLUDE JVCL.UnitText.dtx>
Author
  Marcel Bestebroer
----------------------------------------------------------------------------------------------------
@@TAppStoreEnumOption
<TITLE TAppStoreEnumOption type>
Summary
  Specifies enumeration options.
Description
  The TAppStoreEnumOption type is used to specify the options for enumerating folders and values in
  the storage backend.
See Also
  TJvCustomAppStore.GetStoredValues
@@TAppStoreEnumOption.aeoFolders
  Enumerate folders (containers for values).
@@TAppStoreEnumOption.aeoValues
  Enumerate values.
@@TAppStoreEnumOption.aeoReportListAsValue
  Report lists as a single value. A list is generally a folder containing a 'Count' value and a
  number of items. If this option is specified such folders are reported as a single
  value.
@@TAppStoreEnumOption.aeoReportRelative
  Report all folders and values relative to the specified search path. If this option is not
  specified all reported folders and values are fully qualified (and start with a backslash).
@@TAppStoreEnumOption.aeoRecursive
  Search sub folders.
----------------------------------------------------------------------------------------------------
@@TAppStoreEnumOptions
<TITLE TAppStoreEnumOptions type>
<COMBINE TAppStoreEnumOption>
----------------------------------------------------------------------------------------------------
@@TAppStoreListDelete
<TITLE TAppStoreListDelete type>
Summary
  Event type used to delete (part of) a list.
Description
  The TAppStoreListDelete event is used to delete (part of) a list.
Parameters
  Sender - Reference to the backend storage requesting the delete.
  Path   - Path of the list.
  First  - First item to remove.
  Last   - Last item to remove.
See Also
  TJvCustomAppStore.WriteList
----------------------------------------------------------------------------------------------------
@@TAppStoreListItem
<TITLE TAppStoreListItem type>
Summary
  Event type used to read or write a list item.
Description
  The TAppStoreListItem event is used to read or write a specific item in the list.
Parameters
  Sender - Reference to the backend storage requesting the read or write.
  Path   - Path of the list.
  Index  - Index of the item to read or write.
See Also
  TJvCustomAppStore.ReadList, TJvCustomAppStore.WriteList
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore
Summary
  Abstract base class for application data storage.
Description
  TJvCustomAppStore is the abstract base class for application storage. The base class provides the
  abstract interface to read and write data in addition to some generic methods to manipulate or
  retrieve data.

  The application storage components are used with various components in the JEDI-VCL library to
  provide a means to store their data to a user specified destination. Because all storages use this
  component interface, other components don't need to worry about how their information is stored or
  where it is stored.

  Data is referenced much like a file on an Operating System. The storage system uses paths and uses
  the concept of folders and values (much like folders and files on an OS). The storage
  component can specify a <LINK Root, root path> that is to serve as the absolute root of the
  storage (i.e. the storage can not reference anything that is not a child of this root path).
  Components and user code can specify paths that are either relative to a
  <LINK Path, previously set path> or relative to the <LINK Root, root folder>.

  Folder names consisting solely of '.' (dot) characters are used to reference folders above the
  current one. Using one dot refers to the current folder. Every additional dot goes up one level in
  the storage tree. Example: if the current path is set to 'MyFolder1\MyFolder1.1\MyFolder1.1.1', a
  path specified as '..\MyFolder1.1.2' would translate into 'MyFolder1\MyFolder1.1\MyFolder1.1.2'
  and a path specified as '...\MyFolder1.2\MyFolder1.2.1' or '..\..\MyFolder1.2\MyFolder1.2.1'
  would translate into 'MyFolder1\MyFolder1.2\MyFolder1.2.1'.

  In addition you can link other storages into the storage tree, where each sub storage would be
  accessible through a specific path. This allows one to use a single storage to access both
  generic settings (common for the machine the application runs on, e.g. a registry backend pointing
  to HKEY_LOCAL_MACHINE) and user settings (unique for each user, e.g. an INI file backend pointing
  to an INI file in the current users home directory), making the access to the settings easier to
  use. Not all storages may surface this linking mechanism, but most do.

  You should not instantiate a TJvCustomAppStore but rather one of it's descendants.
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore.ConcatPaths
Summary
  Combines paths into one (canonical) path.
Description
  ConcatPaths will combine the specified paths into a single path. The resulting path will be in
  canonical form (relative folder specifications are resolved to their final path).

  Below is a table of examples with different paths and their resulting value:
  <TABLE>
    Paths                                         Result
    =====                                         ======
    'MyFolder1' and 'MyFolder2'                   MyFolder1\MyFolder2
    'MyFolder1\MyFolder2' and '..\MyFolder3'      MyFolder1\MyFolder3
    'MyFolder1\MyFolder2' and '\MyFolder4'        MyFolder4
    'MyFolder1\MyFolder2', '\MyFolder4',
      '\MyFolder5\MyFolder6\MyFolder7\MyFolder8',
      '...\MyFolder9\MyFolder10' and
      '..\MyFolder11'                             MyFolder5\MyFolder9\MyFolder11
  </TABLE>
Parameters
  Paths - List of paths to combine into one.
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore.DeleteSubTree
Summary
  Deletes the specified folder/value and any sub folders.
Description
  DeleteSubTree will remove the specified folder and it's sub folders and all values. If the
  specified path refers to a value, the value will be deleted.
Parameters
  Path - Path (relative to the current path) of the sub tree to delete.
See Also
  DeleteValue
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore.DeleteValue
Summary
  Deletes the specified value.
Description
  DeleteValue will delete the specified value. If the specified path does not refer to a value the
  method will not do anything.
Parameters
  Path - Path (relative to the current path) of the value to delete.
See Also
  DeleteSubTree
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore.GetStoredValues
Summary
  Retrieves a list of values and folders in the storage.
Description
  GetStoredValue will retrieve a list of values and/or folders in the storage. The scanning will
  start in the specified folder and returned in the TStrings list provided. The Options parameter
  will determine what will be returned and how, and wether or not sub folders are scanned.
Parameters
  Path    - Path (relative to the current path) of the folder to scan.
  Strings - TStrings descendant to receive the list of values and or folders. Each item will refer
              to a folder and/or a value. The associated TObject is actually an Integer containing
              a combination of the aptFolder and aptValue flags.
  Options - Scanning options to use (see TAppStoreEnumOptions for more information).
See Also
  TAppStoreEnumOptions
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore.IsFolder
Summary
  Determines if the specified path is a folder.
Description
  IsFolder determines if the specified path refers to a folder or a value. The specified path is
  considered to be a folder is:

  * It has sub folders or values
  * ListIsValue is False or if it's True the path does not refer to a list (a folder is considered
    a list if it contains the Count value and only Item<I>x</I> values; if it contains other values
    as well it's considered to be a folder and a value).

  If the specified path refers to a folder IsFolder returns True, otherwise False is returned.
Parameters
  Path        - Path (relative to the current path) to check.
  ListIsValue - Flag to interprete a list as value or not.
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore.ListStored
Summary
  Determines if the specified path is a list.
Description
  ListStored determines if the specified path is a list. A folder is considered to be a list if it
  contains the Count value and Item<I>x</I> values (<I>x</I> being a 0-based index).

  If the specified path refers to a list ListStored returns True, otherwise False is returned.
Parameters
  Path - Path (relative to the current path) to check.
See Also
  IsFolder, ValueStored
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore.Path
Summary
  Specifies the current path.
Description
  Path specified the current path. This paths is prepended to any of the accessing methods to
  determine the actual path. It can be used to simplify code dealing with storages. By setting the
  base path to use you can minimize the paths used in the calls to the Read* or Write* methods to
  sub folders.

  Note that this path is relative to the absolute storage root specified by the Root property.
See Also
  Root
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore.ResolvePath
Summary
  Resolves the specified path to a target storage and target path.
Description
  ResolvePath will resolve the specified path into a storage backend and path to use. The storage
  returned might be itself, one of it's sub stores or a sub store at an even deeper level. In any
  case, the returned store and path will no longer reference to any other sub store.

  ResolvePath will take the specified path, prefixing it with the currently set path and
  canonicalize it (making it relative to the absolute root of the storage).

  It will then  scan the sub storages to see if the path refers to a linked storage. If it doesn't,
  this storage will be returned as the target store and the canonicalized path as the target path.

  If it did find a sub store, the link path is removed from the canonical path (making it relative
  to the absolute root of the sub store) and ResolvePath is executed on the sub store. Eventually
  the sub store to use and the path relative to the absolute root of that store are returned.
Parameters
  InPath    - The path to resolve. This may be any path specification, even one that's relative to
              the currently selected path.
  TgtStore  - The target store to use. The returned store is guaranteed to be the store that should
              contain the specified path (ie. it can not reference any of it's linked sub stores).
  TgtPath   - The path to use in the target store. The returned path is always canonical and
              relative to the absolute root of the target store specified by TgtStore and will
              reference the path specified by InPath.
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore.ReadBinary
Summary
  Reads a binary value.
Description
  ReadBinary reads a value from the storage in a binary form. The method will read atmost BufSize
  bytes and put it in the location pointed to by Buf. The result value indicates the number of bytes
  actually read.
Parameters
  Path    - Path (relative to the current path) of the value to read.
  Buf     - Buffer in which to put the data read.
  BufSize - Size of the buffer. ReadBinary will return at most BufSize bytes.
See Also
  WriteBinary, ReadDateTime, ReadFloat, ReadInteger, ReadList, ReadString, ReadStringList
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore.ReadDateTime
Summary
  Reads a TDateTime value.
Description
  ReadDateTime reads date and time value from the storage. The result value is the value in the
  storage or the specified default value if it did not exist in the storage.
Parameters
  Path    - Path (relative to the current path) of the value to read.
  Default - Value to return if the specified path does not exist.
See Also
  WriteDateTime, ReadBinary, ReadFloat, ReadInteger, ReadList, ReadString, ReadStringList
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore.ReadFloat
Summary
  Reads a floating point value.
Description
  ReadFloat reads a floating point value from the storage. The result value is the value in the
  storage or the specified default value if it did not exist in the storage.
Parameters
  Path    - Path (relative to the current path) of the value to read.
  Default - Value to return if the specified path does not exist.
See Also
  WriteFloat, ReadBinary, ReadDateTime, ReadInteger, ReadList, ReadString, ReadStringList
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore.ReadInteger
Summary
  Reads an integer value.
Description
  ReadInteger reads an integer value from the storage. The result value is the value in the
  storage or the specified default value if it did not exist in the storage.
Parameters
  Path    - Path (relative to the current path) of the value to read.
  Default - Value to return if the specified path does not exist.
See Also
  WriteInteger, ReadBinary, ReadDateTime, ReadFloat, ReadList, ReadString, ReadStringList
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore.ReadList
Summary
  Reads a list of items.
Description
  ReadList reads a list of items from the storage. The result values is the number of items in the
  list or 0 if the list does not exist in the storage.

  ReadList is a general purpose method that can read any list by means of the provided read method.
  The specified method will be called for each item individually, specifying the list path and the
  item index to read. The method should read the item (which can be as simple as reading in a single
  value to as complex as reading in an entire group of values and/or sub lists) and process the data
  immediately (e.g. store it in memory or display it in a control).
Parameters
  Path       - Path (relative to the current path) of the value to read.
  OnReadItem - Method that will read each item from the storage.
See Also
  WriteList, ReadBinary, ReadDateTime, ReadFloat, ReadInteger, ReadString, ReadStringList
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore.ReadString
Summary
  Reads a string value.
Description
  ReadString reads a string value from the storage. The result value is the value in the
  storage or the specified default value if it did not exist in the storage.
Parameters
  Path    - Path (relative to the current path) of the value to read.
  Default - Value to return if the specified path does not exist.
See Also
  WriteString, ReadBinary, ReadDateTime, ReadFloat, ReadInteger, ReadList, ReadStringList
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore.ReadStringList
Summary
  Reads a list of strings.
Description
  ReadStringList reads a list of strings from the storage. ReadStringList uses the ReadList method
  in combination with a specialised OnReadItem handler that will read the individual items in from
  the list. Items are expected to be stored in the <B>Item<I>x</I></B> format where <I>x</I> is the
  0-based index of the item.

  The returned value is the number of strings read.
Parameters
  Path       - Path (relative to the current path) of the value to read.
  SL         - \String list in which to store the strings from the storage.
  ClearFirst - Flag to indicate if the string list should be cleared before reading commences.
See Also
  WriteStringList, ReadBinary, ReadDateTime, ReadFloat, ReadInteger, ReadList, ReadString
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore.Root
Summary
  Specifies absolute root.
Description
  Root specifies the absolute root for the storage. It's primarily used for storages that are not
  application specific (like the registry) to determine the exact path under which all other values
  and folders will be located.

  In contrast to the Path property, none of the methods are allowed to specify levels above this
  path, nor any siblings of this path.
See Also
  Path
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore.ValueStored
Summary
  Determines if the specified path is a value.
Description
  ValueStored determines if the specified path is a value that is stored in the storage. If the
  path does not point to a value ValueStored returns False, otherwise True will be returned.
Parameters
  Path - Path (relative to the current path) to check.
See Also
  IsFolder, ListStored
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore.WriteBinary
Summary
  Stores the buffer in a binary form.
Description
  WriteBinary will write BufSize bytes of the buffer indicated by Buf to the storage in a binary
  form.
Parameters
  Path    - Path (relative to the current path) where the value is to be stored.
  Buf     - Data to write to the storage.
  BufSize - Size of the buffer.
See Also
  ReadBinary, WriteDateTime, WriteFloat, WriteInteger, WriteList, WriteString, WriteStringList
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore.WriteDateTime
Summary
  Stores a date and time value.
Description
  WriteDateTime will store the specified date and time value in the specified location.
Parameters
  Path  - Path (relative to the current path) where the value is to be stored.
  Value - Value to store.
See Also
  ReadDateTime, WriteBinary, WriteFloat, WriteInteger, WriteList, WriteString, WriteStringList
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore.WriteFloat
Summary
  Stores a floating point value.
Description
  WriteFloat will store the specified floating point value in the specified location.
Parameters
  Path  - Path (relative to the current path) where the value is to be stored.
  Value - Value to store.
See Also
  ReadFloat, WriteBinary, WriteDateTime, WriteInteger, WriteList, WriteString, WriteStringList
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore.WriteInteger
Summary
  Stores an integer value.
Description
  WriteInteger will store the specified integer value in the specified location.
Parameters
  Path  - Path (relative to the current path) where the value is to be stored.
  Value - Value to store.
See Also
  ReadInteger, WriteBinary, WriteDateTime, WriteFloat, WriteList, WriteString, WriteStringList
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore.WriteList
Summary
  Stores a list of items.
Description
  WriteList stores a list of items in the storage.

  WriteList is a general purpose method that can store any list by means of the provided write
  method. The specified write method will be called for each item individually, specifying the list
  path and the item index to store. The method should write the item (which can be as simple as
  writing a single value to as complex as writing an entire group of values and/or sub lists).

  The specified delete method is called to clear out the remaining part of the list that is no
  longer to be stored (i.e. overwriting a larger list with a smaller list). The method is called
  only once, specifying the range of items to be removed. The method should then remove said items
  from the storage.
Parameters
  Path          - Path (relative to the current path) where the list is to be stored.
  ItemCount     - Number of items to store.
  OnWriteItem   - Method that will write each item to the storage.
  OnDeleteItems - Method that will remove remaining items from a previous list.
See Also
  ReadList, WriteBinary, WriteDateTime, WriteFloat, WriteInteger, WriteString, WriteStringList
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore.WriteString
Summary
  Stores a string value.
Description
  WriteString will store the specified string value in the specified location.
Parameters
  Path  - Path (relative to the current path) where the value is to be stored.
  Value - Value to store.
See Also
  ReadString, WriteBinary, WriteDateTime, WriteFloat, WriteInteger, WriteList, WriteStringList
----------------------------------------------------------------------------------------------------
@@TJvCustomAppStore.WriteStringList
  Stores a list of strings.
Description
  WriteStringList stores a list of strings in the storage. WriteStringList uses the WriteList method
  in combination with specialised OnWriteItem and OnDeleteItems handlers that will write the
  individual items from the list in the storage and remove exxesive items. Items are stored in the
  <B>Item<I>x</I></B> format where <I>x</I> is the 0-based index of the item.
Parameters
  Path - Path (relative to the current path) where the strings are to be stored.
  SL   - \String list to store.
See Also
  ReadStringList, WriteBinary, WriteDateTime, WriteFloat, WriteInteger, WriteList, WriteString
