<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="content-type">
  <title>Jedi Package Generator</title>
  <link rel="STYLESHEET" type="text/css" href="styles/default.css">
</head>
<body>
<h1>Jedi Package Generator</h1>
<hr style="width: 100%; height: 2px;"><br>
In an effort to easify the generation of component packages for the
JVCL, a package generator has been created. Even if it is extensively
used by the JVCL team, it has been designed to be as generic as
possible and as such may seem a bit complex at first. You will find in
this file the documentation you need to understand how to take
advantage of this tool.<br>
The package generator comes in two different version: Graphical User
Interface (pgEdit.exe) and Command Line (pg.exe). They both work from
the same set of XML configuration files, pgEdit having the advantage to
allow you to safely edit the source XML files. Here is the flow diagram:<br>
<br>
<div style="text-align: center;"><img
 style="width: 533px; height: 454px;" alt="Package Generator Flow"
 src="images/pg-flow.png"><br>
</div>
<br>
Each file has its own role:<br>
<br>
<table style="text-align: left; width: 100%;" border="0" cellspacing="0"
 cellpadding="2">
  <tbody>
    <tr>
      <td style="vertical-align: top; white-space: nowrap;"><a
 href="#Package_XML_Source_Files_Format">Package XML
Source Files</a><br>
      </td>
      <td style="vertical-align: top;">Each packageXML source file
indicates which files are to be included in the package, which other
packages this package depends on and various compilation options such
as PFLAGS (Pascal Flags) for C++ Builder. All inclusions and
dependencies can be conditionned by a compilation directive.<br>
A runtime package should have the '-R' suffix, while a design time
package should have a '-D' suffix. Hence, JvCore-R.xml is a runtime
package source file while JvCore-D.xml is a design time package source
file.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><a
 href="#XML_Configuration_File_Format">XML Configuration File</a><br>
      </td>
      <td style="vertical-align: top;">This file contains the
declaration of models that the package generator will use to generate
the files. Each model declares targets (one version of Delphi, C++
Builder or Kylix) the format of the filenames to output, the location
of
package files and a possible include file.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><a href="#Template_Files_Format">Template
Files</a><br>
      </td>
      <td style="vertical-align: top;">These files are skeletons for
the final output files. They contain special markers that will get
replaced by values taken from the XML configuration file and the
Package Source XML files to generate the final output files.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><a href="#Include_File_parsing">Include
File</a><br>
      </td>
      <td style="vertical-align: top;">The Delphi packages are Pascal
source files and as such can include conditional compilation
directives. However C++ Builder package source files are XML files and
as a result do not support conditions. Hence when modifications are
done to
an include file that have impact on which files are to be included in a
package, you must regenerate the packages for C++ Builder. The
conditions are read from the include file given to the package
generator.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Existing Output Files<br>
      </td>
      <td style="vertical-align: top;">If the files to be generated
already exist, they will be used to determine if any change was done to
them since the last time they were generated. If not, the output files
will be left untouched.<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
<h2><a name="Package_XML_Source_Files_Format"></a>Package XML Source
Files Format</h2>
Here is a basic XML source file (Extracted from JvCore-R.xml):<br>
<br>
<table
 style="width: 80%; text-align: left; margin-left: auto; margin-right: auto;"
 border="0" cellspacing="0" cellpadding="2">
  <tbody>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(204, 204, 204);"><code>&lt;?xml
version="1.0" encoding="iso-8859-1"?&gt;<br>
&lt;Package Name="JvCore" Design="0"&gt;<br>
&nbsp; &lt;Description&gt;JVCL Core Runtime Package&lt;/Description&gt;<br>
&nbsp; &lt;C5PFlags&gt;-LUCJcl50&lt;/C5PFlags&gt;<br>
&nbsp; &lt;C6PFlags&gt;-LUCJcl&lt;/C6PFlags&gt;<br>
&nbsp; &lt;C5Libs/&gt;<br>
&nbsp; &lt;C6Libs/&gt;<br>
&nbsp; &lt;Requires&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;Package Name="ThemeManager6"
Targets="D6,D6p,C6,C6p"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Condition="JVCLThemesEnabled"/&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;Package
Name="CJCL"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Targets="C6,C6p" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp;
Condition=""/&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;Package
Name="vclx"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Targets="D6,D6p,D7,D7p,C6,C6p,K2,K3" Condition=""/&gt;<br>
&nbsp; &lt;/Requires&gt;<br>
&nbsp; &lt;Contains&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;File
Name="..\..\common\JvConsts.pas"&nbsp;&nbsp;&nbsp;&nbsp;
Targets="all" Formname="" &nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Condition=""/&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;File Name="..\..\run\JvColorProvider.pas"
Targets="all"
Formname=""&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Condition=""/&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;File
Name="..\..\run\JvComponent.pas"&nbsp;&nbsp;&nbsp;&nbsp;
Targets="all"
Formname=""&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Condition=""/&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;File Name="..\..\run\JvJVCLAboutForm.pas"
Targets="all" Formname="JvJVCLAboutForm" Condition=""/&gt;<br>
&nbsp; &lt;/Contains&gt;<br>
&lt;/Package&gt;<br>
      </code></td>
    </tr>
  </tbody>
</table>
<br>
When reading those files, the package generator doesn't check for the
existence of the nodes and properties in the XML file. It assumes they
exist and if they don't you will most likely end up with an Access
Violation exception.
This is why we recommend that you use pgEdit.exe to edit these files,
which
will ensure the format of the xml files is correct. Here is a
description of each node and its usage:<br>
<br>
<table style="text-align: left; width: 100%;" border="1" cellspacing="1"
 cellpadding="2">
  <tbody>
    <tr>
      <td
 style="vertical-align: top; text-align: center; font-weight: bold;">Node<br>
      </td>
      <td
 style="vertical-align: top; text-align: center; font-weight: bold;">Parent
Node<br>
      </td>
      <td
 style="vertical-align: top; text-align: center; font-weight: bold;">Description<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Package<br>
      </td>
      <td style="vertical-align: top; white-space: nowrap;">none (root
node)<br>
      </td>
      <td style="vertical-align: top;">This is the root node. Its only
properties are Name and Design. Name is obviously the name of the
package while Design is 1 when the package is a designtime package, 0
when it is a run time package. The root node doesn't have to be called
package, but it MUST have those two properties.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Description<br>
      </td>
      <td style="vertical-align: top;">Package<br>
      </td>
      <td style="vertical-align: top;">This is the description of the
package as it will be displayed in the IDE.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">C5PFlags<br>
      </td>
      <td style="vertical-align: top;">Package<br>
      </td>
      <td style="vertical-align: top;">The package files for C++
Builder 5 contain a special node to allow to pass extra arguments to
the pascal compiler. This node indicates the value to use for the
PFLAGS node in C++ Builder 5 packages. In the example above, we put
-LUCJcl50 to indicate to link the file CJcl50.dcp into the package.
Options are separated by spaces and if followed by a string in
parenthesis, the string is considered to be a condition. If the
condition doesn't exist when the file are generated, the option is
removed. For instance, if you type -LUCJcl50(USEJVCL) then if USEJVCL
is not defined in the include file, -LUCJcl50 will be removed from the
final PFLAGS value. This final value will be the replacement for
%C5PFLAGS% in
template files.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">C6PFlags<br>
      </td>
      <td style="vertical-align: top;">Package<br>
      </td>
      <td style="vertical-align: top;">This is node has the same
meaning as C5PFlags but for C++ Builder 6, hence being the replacement
for %C6PFLAGS%<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">C5Libs<br>
      </td>
      <td style="vertical-align: top;">Package<br>
      </td>
      <td style="vertical-align: top;">In some rare occasions, it may
be necessary to indicate some extra libraries to the C++ linker. This
happened for instance with the Network related packages in the JVCL as
they required wininet.lib. The value here should be a space separated
list of library files and will be the replacement for %C5LIBS%<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">C6Libs<br>
      </td>
      <td style="vertical-align: top;">Package<br>
      </td>
      <td style="vertical-align: top;">This node has the same meaning
as C5Libs but will be the replacement for %C6LIBS%<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Requires<br>
      </td>
      <td style="vertical-align: top;">Package<br>
      </td>
      <td style="vertical-align: top;">This node is only the parent of
all the 'package' nodes, those nodes indicating the packages required
by
the current package.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Contains<br>
      </td>
      <td style="vertical-align: top;">Package<br>
      </td>
      <td style="vertical-align: top;">This node is only the parent of
all the 'file' nodes, those nodes indicating the files contained in the
current package. </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Package<br>
      </td>
      <td style="vertical-align: top;">Requires<br>
      </td>
      <td style="vertical-align: top;">Each package node in a Require
node indicates a package that the current one requires in order to be
compiled. It must have those three attributes:<br>
      <table style="text-align: left; width: 100%;" border="0"
 cellspacing="0" cellpadding="2">
        <tbody>
          <tr>
            <td style="vertical-align: top;">Name<br>
            </td>
            <td style="vertical-align: top;">The name of the package
that is being required. No extension shall be given here. If the name
starts with the prefix indicated for the current model, then it will be
modified according to the format indicated in the model. For instance,
if Name is 'JvCore-R', prefix is 'Jv', format is '%p%e%v%t' and the
current target is C++ Builder 6 then the name will be replaced by
JvCoreC6R. Please see the detailed description of the generation
process for further information.<br>
            </td>
          </tr>
          <tr>
            <td style="vertical-align: top;">Targets<br>
            </td>
            <td style="vertical-align: top;">The targets for which the
package is to be required.<br>
            </td>
          </tr>
          <tr>
            <td style="vertical-align: top;">Condition<br>
            </td>
            <td style="vertical-align: top;">The condition under which
the package is to be required. If empty, no condition is necessary to
require the package in the current one.<br>
            </td>
          </tr>
        </tbody>
      </table>
      <br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">File<br>
      </td>
      <td style="vertical-align: top;">Contains<br>
      </td>
      <td style="vertical-align: top;">Each file node in a Contains
node indicates a file that is to be included in the package. It must
have those four attributes:<br>
      <table style="text-align: left; width: 100%;" border="0"
 cellspacing="0" cellpadding="2">
        <tbody>
          <tr>
            <td style="vertical-align: top;">Name<br>
            </td>
            <td style="vertical-align: top;">The name of the file to
include. The extension must be indicated.<br>
            </td>
          </tr>
          <tr>
            <td style="vertical-align: top;">Targets<br>
            </td>
            <td style="vertical-align: top;">The targets for which the
file is to be included.<br>
            </td>
          </tr>
          <tr>
            <td style="vertical-align: top;">Formname<br>
            </td>
            <td style="vertical-align: top;">The name of the form (dfm)
associated with the pas file, if any. It is not the type name, but the
name of the form that must be indicated here. For instance if the form
is of type TForm1 then the value must be Form1. Moreover, if the dfm
file describes a Frame or a Data Module, the name must be followed by a
colon, a space and TFrame or TDataModule (as in 'myFrame: TFrame').<br>
            </td>
          </tr>
          <tr>
            <td style="vertical-align: top;">Condition<br>
            </td>
            <td style="vertical-align: top;">The condition under which
the file is to be included. If empty, no
condition is necessary to include the file.</td>
          </tr>
        </tbody>
      </table>
      <br>
      </td>
    </tr>
  </tbody>
</table>
<br>
<br>
<h2><a name="XML_Configuration_File_Format"></a>XML Configuration File
Format</h2>
Here is a basic XML Configuration file, derived from the full
pgEdit.xml distributed with the JVCL:<br>
<br>
<table
 style="width: 80%; text-align: left; margin-left: auto; margin-right: auto;"
 border="0" cellspacing="0" cellpadding="2">
  <tbody>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(204, 204, 204);"><code>&lt;?xml
version="1.0" encoding="iso-8859-1"?&gt;<br>
&lt;Configuration&gt;<br>
&nbsp; &lt;pgEdit&gt;<br>
&nbsp;&nbsp;&nbsp;
&lt;odlAddFiles_InitialDir&gt;..\..\run&lt;/odlAddFiles_InitialDir&gt;<br>
&nbsp;&nbsp;&nbsp;
&lt;cmbModel_ItemIndex&gt;0&lt;/cmbModel_ItemIndex&gt;<br>
&nbsp; &lt;/pgEdit&gt;<br>
&nbsp; &lt;models&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;model name="JVCL" prefix="Jv"
format="%p%n%e%v%t" <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
packages="..\..\packages" incfile="..\..\common\jvcl.inc"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;targets&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;target name="d7"
pname="d7p" pdir="d7per" defines="COMPILER7_UP"/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/targets&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;aliases&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;alias name="Delphi"
value="d7,d7p"/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/aliases&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;/model&gt;<br>
&nbsp; &lt;/models&gt;<br>
&lt;/Configuration&gt;</code><br>
      </td>
    </tr>
  </tbody>
</table>
<br>
Contrary to the package XML source files, the validity of this file is
checked when read and an explicative message will be given to you if
the file is corrupted. However, a non corrupted file doesn't mean it
does something useful. For that, you need to indicate the correct
values according to the following table:<br>
<br>
<table style="text-align: left; width: 100%;" border="1" cellspacing="1"
 cellpadding="2">
  <tbody>
    <tr>
      <td
 style="vertical-align: top; text-align: center; font-weight: bold;">Node<br>
      </td>
      <td
 style="vertical-align: top; text-align: center; font-weight: bold;">Parent
Node<br>
      </td>
      <td
 style="vertical-align: top; text-align: center; font-weight: bold;">Description<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Configuration<br>
      </td>
      <td style="vertical-align: top; white-space: nowrap;">node (root
node)<br>
      </td>
      <td style="vertical-align: top;">This is the root node of the XML
file. It doesn't have to have any attributes and may be named
differently, but that would mean that pgEdit.exe needs to be changed to
cope with the modification. pg.exe wouldn't mind.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">pgEdit<br>
      </td>
      <td style="vertical-align: top;">Configuration<br>
      </td>
      <td style="vertical-align: top;">This node contains all the
subnodes required by pgEdit to save its state when closed down. The
state includes the values of various component fields, the size of the
form,
its position...<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">models<br>
      </td>
      <td style="vertical-align: top;">Configuration<br>
      </td>
      <td style="vertical-align: top;">This node holds the model nodes,
those nodes being the actual configuration described in this file.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">model<br>
      </td>
      <td style="vertical-align: top;">models<br>
      </td>
      <td style="vertical-align: top;">Each model node defines a
generation model that can be used by the package generator. The five
attributes are compulsory and serve the following purpose:<br>
      <table style="width: 100%; text-align: left;" border="0"
 cellspacing="0" cellpadding="2">
        <tbody>
          <tr>
            <td style="vertical-align: top;">name<br>
            </td>
            <td style="vertical-align: top;">The name of the model<br>
            </td>
          </tr>
          <tr>
            <td style="vertical-align: top;">prefix<br>
            </td>
            <td style="vertical-align: top;">The prefix indicates the
first characters of package names that are to be modified when
encountered in a required package node for a package to generate.
Please see the detailled description of the <a
 href="#Detailed_Generation_process">generation process</a> for further
information.<br>
            </td>
          </tr>
          <tr>
            <td style="vertical-align: top;">format<br>
            </td>
            <td style="vertical-align: top;">The format of the string
that will replace a package name that matched the prefix. Please see
the detailed description of the <a href="#Detailed_Generation_process">generation
process</a> for further information. Some special markers will get
replaced:<br>
            <table style="width: 100%; text-align: left;" border="0"
 cellspacing="0" cellpadding="2">
              <tbody>
                <tr>
                  <td style="vertical-align: top;">%e<br>
                  </td>
                  <td style="vertical-align: top;">The environment one
letter indicator. See below for more details<br>
                  </td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">%n<br>
                  </td>
                  <td style="vertical-align: top;">The package name,
without its suffix. Hence JvCore-R would give Core in the example above.</td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">%p</td>
                  <td style="vertical-align: top;">The prefix. In the
example above, Jv<br>
                  </td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">%t<br>
                  </td>
                  <td style="vertical-align: top;">The type of package.
Simply the letter after the dash. JvCore-R gives R for instance<br>
                  </td>
                </tr>
                <tr>
                  <td style="vertical-align: top;">%v</td>
                  <td style="vertical-align: top;">The version of the
target. See below for more details<br>
                  </td>
                </tr>
              </tbody>
            </table>
Delphi and C++ Builder prior to version 6 do not support the LibSuffix
concept. If you want to emulate it with your packages, you may find
usefull this fact:<br>
If there is a comma in the format string, then it is considered as a
separator. What is before it is used for all versions starting from 6,
and what is after it is used for all versions before 6.<br>
            </td>
          </tr>
          <tr>
            <td style="vertical-align: top;">packages<br>
            </td>
            <td style="vertical-align: top;">The location of the
packages. This is considered as a root, meaning that the Package XML
source files will be searched in the xml subdirectory. Then the
directories used to output the files for each targets will have to
exist in this pseudo root directory.<br>
            </td>
          </tr>
          <tr>
            <td style="vertical-align: top;">incfile<br>
            </td>
            <td style="vertical-align: top;">The name of the include
file to parse. This only has an impact for C++ Builder targets<br>
            </td>
          </tr>
        </tbody>
      </table>
      <br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">targets<br>
      </td>
      <td style="vertical-align: top;">model<br>
      </td>
      <td style="vertical-align: top;">This node holds the target
nodes, one node for each target your suite can support<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">aliases<br>
      </td>
      <td style="vertical-align: top;">model<br>
      </td>
      <td style="vertical-align: top;">This node holds the alias nodes,
one node for each target alias you want to provide. In the example
above, using Delphi in a target node in a package XML source file is
equivalent to using d7,d7p. The aliases are not resolved recursively
and are not case sensitive. You don't have to define the 'all' alias,
it will be derived from the list of targets.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">target<br>
      </td>
      <td style="vertical-align: top;">targets<br>
      </td>
      <td style="vertical-align: top;">Each target node must have at
least the name attribute. All other attributes are optionnal:<br>
      <table style="width: 100%; text-align: left;" border="0"
 cellspacing="0" cellpadding="2">
        <tbody>
          <tr>
            <td style="vertical-align: top;">name<br>
            </td>
            <td style="vertical-align: top;">The name of the target,
compulsory.<br>
            </td>
          </tr>
          <tr>
            <td style="vertical-align: top;">dir<br>
            </td>
            <td style="vertical-align: top;">The directory where to
generate the packages. Defaults to name. It must exists in the packages
directory before starting the generation of packages. If not, errors
will occur and the error messages may not be self-explanatory.<br>
            </td>
          </tr>
          <tr>
            <td style="vertical-align: top;">pname<br>
            </td>
            <td style="vertical-align: top;">The name of the associated
Perso target. A perso target is the target that will be used to force
the generation of a different package for a version of the target that
do not support some features (Database generally). Leave empty or do
not define if there are no reason to use this feature. For instance,
Delphi 7 Personal Edition doesn't support Databases. With the example
above you could use the d7 target alone when specifying a file that is
to be included for Delphi 7 and not Delphi 7 Personal Edition. Use
'd7,d7p' when including a file that must be used for all versions of
Delphi 7.<br>
            </td>
          </tr>
          <tr>
            <td style="vertical-align: top;">pdir<br>
            </td>
            <td style="vertical-align: top;">The directory for the
associated perso target. Defaults to pname<br>
            </td>
          </tr>
          <tr>
            <td style="vertical-align: top;">env<br>
            </td>
            <td style="vertical-align: top;">A character to identify
the development environment. Defaults to the first character of name.
Expected values are D for delphi, C for C++ Builder and K for Kylix.
Any other value will most likely lead to errors while generating the
packages.<br>
            </td>
          </tr>
          <tr>
            <td style="vertical-align: top;">ver<br>
            </td>
            <td style="vertical-align: top;">A character to identify
the version of the environment. Defaults to the second character of
name. The expected value is a number and errors will arise if it is
not. For instance, for Delphi 7, it should be 7.<br>
            </td>
          </tr>
          <tr>
            <td style="vertical-align: top;">defines<br>
            </td>
            <td style="vertical-align: top;">A comma separated string
to indicate which Conditional Compilation symbols are defined as the
result of using this target so that your include file can enclose some
$DEFINE in $IFDEF that relate to the compiler being used. For instance,
in the JVCL, we have the JVCLThemesEnabled compilation directive. It
can be turned on manually, but if the target compiler is version 7 or
upper, it is always turned on as the theme support is included in the
Delphi distribution. Hence in the include file, we have this:<br>
            <code><br>
            </code>
            <table
 style="text-align: left; background-color: rgb(204, 204, 204); width: 100%;"
 border="0" cellspacing="0" cellpadding="2">
              <tbody>
                <tr>
                  <td
 style="vertical-align: top; background-color: rgb(204, 204, 204);"><code>{$IFDEF
COMPILER7_UP}<br>
&nbsp; {$DEFINE JVCLThemesEnabled}<br>
{$ENDIF}<br>
                  </code></td>
                </tr>
              </tbody>
            </table>
            <code></code><br>
Now, when a file is included with the JVCLThemesEnabled condition, it
will only be if the COMPILER7_UP condition is also available. But this
is only the case when compiling because it is derived from the version
number of the compiler. However, you can specifically indicate that a
given target will define a condition using this attribute, hence
mimicking what happens during compilation. Please refer to the <a
 href="#Include_File_parsing">Include File parsing</a> section for more
information on the handling of the include file.<br>
            </td>
          </tr>
        </tbody>
      </table>
      <br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">alias<br>
      </td>
      <td style="vertical-align: top;">aliases<br>
      </td>
      <td style="vertical-align: top;">Each alias node must have those
two attributes:<br>
      <table style="width: 100%; text-align: left;" border="0"
 cellspacing="0" cellpadding="2">
        <tbody>
          <tr>
            <td style="vertical-align: top;">name<br>
            </td>
            <td style="vertical-align: top;">The name of the alias<br>
            </td>
          </tr>
          <tr>
            <td style="vertical-align: top;">value<br>
            </td>
            <td style="vertical-align: top;">The comma separated list
of targets this alias will expand to. No recursion is done when
resolving the aliases. If you defined some Perso target, do not forget
to include them in the value for your alias.<br>
            </td>
          </tr>
        </tbody>
      </table>
      <br>
      </td>
    </tr>
  </tbody>
</table>
<br>
<br>
<h2><a name="Template_Files_Format"></a>Template Files Format</h2>
The template files are either binary of text files. To determine if a
file is binary, the first 50 bytes are read from it and if more than 10
percent of them are not ASCII readable characters, the file is
considered to be binary. An ASCII readable character is one from the
[#9, #10, #13, #32..#127] set (Delphi Notation). The results of this
analysis are cached to ensure that this doesn't impact on the speed of
generation.<br>
<br>
If a template file is binary, then no special treatment is applied to
it, it is simply copied over to the output file.<br>
If a template file is text, then it is read lines by lines according to
this state diagram:<br>
<br>
<div style="text-align: center;"><img
 style="width: 530px; height: 394px;" alt="Template state diagram"
 src="images/pg-template-state.png"><br>
</div>
<br>
In each state, special markers can be found on the line being read.
Markers are case sensitive and unless indicated otherwise, can be found
anywhere on the line
and can be present more than once.<br>
<br>
<table
 style="width: 90%; text-align: left; margin-left: auto; margin-right: auto;"
 border="1" cellspacing="1" cellpadding="2">
  <tbody>
    <tr>
      <td
 style="vertical-align: top; font-weight: bold; text-align: center;">State<br>
      </td>
      <td
 style="vertical-align: top; font-weight: bold; text-align: center;">Marker<br>
      </td>
      <td
 style="vertical-align: top; font-weight: bold; text-align: center;">Description<br>
      </td>
    </tr>
    <tr>
      <td colspan="1" rowspan="12"
 style="vertical-align: top; white-space: nowrap;">Standard Line<br>
      </td>
      <td style="vertical-align: top; white-space: nowrap;">&lt;%%%
START REQUIRES %%%&gt;<br>
      </td>
      <td style="vertical-align: top;">Must be alone on the line. Goes
to the 'Requires Section' state<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; white-space: nowrap;">&lt;%%%
START FILES %%%&gt;</td>
      <td style="vertical-align: top;">Must be alone on the line. Goes
to the 'Files Section' state<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; white-space: nowrap;">&lt;%%%
START FORMS %%%&gt;</td>
      <td style="vertical-align: top;">Must be alone on the line. Goes
to the 'Forms Section' state<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; white-space: nowrap;">&lt;%%%
START LIBS %%%&gt;</td>
      <td style="vertical-align: top;">Must be alone on the line. Goes
to the 'Libs Section' state<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; white-space: nowrap;">%NAME%<br>
      </td>
      <td style="vertical-align: top;">Replaced by the name of the
output file<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; white-space: nowrap;">%XMLNAME%<br>
      </td>
      <td style="vertical-align: top;">Replaced by the name of the
package XML source file.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; white-space: nowrap;">%DESCRIPTION%<br>
      </td>
      <td style="vertical-align: top;">Replaced by the description of
the package<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; white-space: nowrap;">%C5PFLAGS%<br>
      </td>
      <td style="vertical-align: top;">Replaced by the value from the
c5pflags node in the package XML source file, after it has been
processed for conditions.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; white-space: nowrap;">%C6PFLAGS%</td>
      <td style="vertical-align: top;">Replaced by the value from the
c6pflags node in the package XML source file, after it has been
processed for conditions.</td>
    </tr>
    <tr>
      <td style="vertical-align: top; white-space: nowrap;">%TYPE%<br>
      </td>
      <td style="vertical-align: top;">Replaced by 'DESIGN' or 'RUN'
depending on the type of the package.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; white-space: nowrap;">%type%<br>
      </td>
      <td style="vertical-align: top;">Replaced by 'd' or 'r' according
to the type of the package.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; white-space: nowrap;">%DATETIME%<br>
      </td>
      <td style="vertical-align: top;">Replaced by the current date and
time adjusted to UTC, formated according to the string 'dd-mm-yyyy
hh:nn:ss' and followed by ' UTC'<br>
      </td>
    </tr>
    <tr>
      <td colspan="1" rowspan="2"
 style="vertical-align: top; white-space: nowrap;">Requires
section<br>
      <br>
      </td>
      <td style="vertical-align: top; white-space: nowrap;">%NAME%<br>
      </td>
      <td style="vertical-align: top;">The name of the package being
required, as taken from the package node in the paclage XML source
file. As explained before, the name may be modified according to the
format for the curent model.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; white-space: nowrap;">&lt;%%% END
REQUIRES %%%&gt;<br>
      </td>
      <td style="vertical-align: top;">Must be alone on the line.
Returns to the 'Standard Line' state.<br>
      </td>
    </tr>
    <tr>
      <td colspan="1" rowspan="7" style="vertical-align: top;">Files
section<br>
Forms section<br>
      <br>
      <br>
      <br>
      <br>
      <br>
      <br>
      </td>
      <td style="vertical-align: top;">%FILENAME% </td>
      <td style="vertical-align: top;">The name of the source file as
taken from the 'file' node in the package XML source file<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">%UNITNAME%<br>
      </td>
      <td style="vertical-align: top;">The name of the source file,
without any path information and without the extension<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">%Unitname%<br>
      </td>
      <td style="vertical-align: top;">Same as %UNITNAME% but the
replacement is all in lower case, except for the first letter which is
put in upper case<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">%FORMNAME%<br>
      </td>
      <td style="vertical-align: top;">The name of the form, if any.
Taken from the formname attribute of the 'file' node in the package XML
source file.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">%FORMTYPE%<br>
      </td>
      <td style="vertical-align: top;">The type of the form, if any.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">%FORMNAMEANDTYPE%<br>
      </td>
      <td style="vertical-align: top;">The name and the type of the
form put together. If no type was specified in the formname attribute,
then it is equivalent to %FORMNAME%<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">%FORMPATHNAME%<br>
      </td>
      <td style="vertical-align: top;">The name of the dfm file
containing the definition of the form.&nbsp; No extension is added, it
is simply the filename to which the extension was removed.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Files section<br>
      </td>
      <td style="vertical-align: top;">&lt;%%% END FILES %%%&gt;<br>
      </td>
      <td style="vertical-align: top;">Must be alone on the line.
Returns to the 'Standard Line' state.
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Forms section<br>
      </td>
      <td style="vertical-align: top;">&lt;%%% END FORMS %%%&gt;<br>
      </td>
      <td style="vertical-align: top;">Must be alone on the line.
Returns to the 'Standard Line' state.
      </td>
    </tr>
    <tr>
      <td colspan="1" rowspan="3" style="vertical-align: top;">Libs
section<br>
      <br>
      <br>
      </td>
      <td style="vertical-align: top;">%FILENAME%<br>
      </td>
      <td style="vertical-align: top;">The filename of the library file<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">%UNITNAME%<br>
      </td>
      <td style="vertical-align: top;">The filename of the library
file, without any path information nor extension<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">&lt;%%% END LIBS %%%&gt;<br>
      </td>
      <td style="vertical-align: top;">Must be alone on the line.
Returns to the 'Standard Line' state.
      </td>
    </tr>
  </tbody>
</table>
<br>
Lines that result in a transtion are not included in the output file.
Any line read in the 'Standard Line' state is written in the output
file after marker replacement has been done. Lines read in the
'Section' states will be repeated according to this table:<br>
<br>
<table
 style="width: 90%; text-align: left; margin-left: auto; margin-right: auto;"
 border="1" cellspacing="1" cellpadding="2">
  <tbody>
    <tr>
      <td
 style="vertical-align: top; font-weight: bold; text-align: center; white-space: nowrap;">Repeating
section<br>
      </td>
      <td
 style="vertical-align: top; font-weight: bold; text-align: center;">Description<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Requires<br>
      </td>
      <td style="vertical-align: top;">The lines read while in this
state will be replaced for every package required by the one being
generated. That is, for every 'package' node found in the package XML
source file. The markers will be replaced before the output occurs.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Libs<br>
      </td>
      <td style="vertical-align: top;">The lines read while in this
state will be replaced for every library to be included in the package
being generated. That is for every name in the space delimited value of
the 'C5Libs' or 'C6Libs' node in the package XML source file. The node
used depends on the target for which the generation takes place. If the
target environment is not C and/or its version is not 5 or 6, the
generator will most likely trigger an error.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Files<br>
      </td>
      <td style="vertical-align: top;">The lines read while in this
state will be replaced for every file to be included in the package
being generated. That is for every file 'node' found in the package XML
source file. The markers will be replaced before the output occurs.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Forms<br>
      </td>
      <td style="vertical-align: top;">This section follows the same
repeat conditions as the Files section, except that a 'file' node will
only be used if its 'formname' attribute is not empty.<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
<h2><a name="Include_File_parsing"></a>Include File parsing</h2>
<br>
<br>
<h2><a name="Detailed_Generation_process"></a>Detailed Generation
process</h2>
<br>
<br>
</body>
</html>
