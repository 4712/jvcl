##Package: Core
##Status: Completed
----------------------------------------------------------------------------------------------------
@@JvAppIniStorage.pas
Summary
  Contains the TJvAppIniStorage component.
<INCLUDE JVCL.UnitText.dtx>
Author
  Marcel Bestebroer
----------------------------------------------------------------------------------------------------
@@TJvAppIniFileStorage
<TITLEIMG TJvAppIniFileStorage>
JVCLInfo
  GROUP=JVCL.System
  FLAG=Component
Summary
  INI-file based application data storage.
Description
  TJvAppIniFileStorage is a data storage backend that stores the data in an INI-file.

  As a descendant of TJvAppIniStorage it provides in the standard interface for storing data (such
  as settings, form positions and sizes, etc) in an INI file format. This data will be stored in an
  actual file.

  The component introduces and publishes three new properties: Buffered to indicate if the storage
  is buffered in memory, FileName to determine which file to use and IdleDelay to determine how long
  the application has to be idle (waiting for user input or inactive) before changes are written to
  the file.

  All the abstract access methods are implemented.
----------------------------------------------------------------------------------------------------
@@TJvAppIniFileStorage.Buffered
Summary
  Specifies if the INI-file is buffered in memory.
Description
  Buffered specifies if the INI-file is buffered in memory.

  When set to True, the file specified by the FileName property is read in completely in memory,
  writing the changes when the component is destroyed (application is closed), Flush is called or
  the application is idle for the time specified by the IdleDelay property.

  When set to False, access is performed on the file specified by FileName property directly.

  Note that in the buffered state, changes to the INI file not done by this instance of the storage
  are not detected and will be overwritten when this storage is overwriting the file.
See Also
  IdleDelay, Flush
----------------------------------------------------------------------------------------------------
@@TJvAppIniFileStorage.FileName
Summary
  Name of the INI file.
Description
  FileName specifies which file is to be used as a storage.
See Also
  Buffered
----------------------------------------------------------------------------------------------------
@@TJvAppIniFileStorage.Flush
Summary
  Writes changes to the file.
Description
  Flush will write any changes made to the storage to the underlaying INI file. Flush has no use if
  Buffered is not set to True or changes where made since the last Flush.

  Flush is called automatically when changes where made and the component is destroyed or the
  application has been idle for at least the time specified by IdleDelay.
See Also
  Buffered, IdleDelay
----------------------------------------------------------------------------------------------------
@@TJvAppIniFileStorage.HasWritten
Summary
  Determines if the in-memory view has changed.
Description
  HasWritten determines if the in-memory view has changed. If this property is True, changes where
  made to the in-memory view of the INI file that have not been written to file yet.

  HasWritten is set automatically when data is written to or removed from the storage and Buffered
  is set to True.
See Also
  Buffered
----------------------------------------------------------------------------------------------------
@@TJvAppIniFileStorage.IdleDelay
Summary
  Time the application has to be idle to automatically write changes to the file.
Description
  IdleDelay specifies the time (in milliseconds) the application has to be idle (waiting for user
  input or not active) to trigger an automatic saving to file of a buffered INI file.

  The time an application is idle is determined by checking the last time a keyboard or mouse
  message was encountered or the storage was accessed.

  IdleDelay has no use if Buffered is not set to True.
See Also
  Buffered, Flush
----------------------------------------------------------------------------------------------------
@@TJvAppIniFileStorage.IniFile
Summary
  Direct reference to the \TCustomIniFile instance.
Description
  IniFile holds a direct reference to the TCustomIniFile instance used. In a non buffered state
  (Buffered set to False) this will be a TIniFile instance, otherwise it's a TMemIniFile instance.
See Also
  Buffered
----------------------------------------------------------------------------------------------------
@@TJvAppIniFileStorage.LastUserAct
Summary
  Timestamp of last user activity.
Description
  LastUserAct contains the timestamp of the last user activity. This can be the last time a keyboard
  or mouse message was detected or the last time the storage was accessed.
----------------------------------------------------------------------------------------------------
@@TJvAppIniStorage
Summary
  Abstract base class for application data storage in INI-file format.
Description
  TJvAppIniStorage is the abstract base class for application storage in INI-file format. The base
  class provides the abstract interface to handle data in an INI-file format. It does not refer to
  an INI-file but implements the TJvCustomAppStorage methods to use an INI-file format using a couple
  of simplified access methods.

  As a descendant of TJvCustomAppStorage, it provides in the standard interface for storing data (such
  as settings, form positions and sizes, etc). This data will be converted to be usable in an
  INI-file like manner.

  The component introduces 4 abstract methods to <LINK ReadValue, read>, <LINK WriteValue, write>,
  <LINK RemoveValue, delete> and <LINK ValueExists, find> values using the Section/Key combination.

  All the abstract access methods are implemented to convert from/to one of the 4 new methods.
----------------------------------------------------------------------------------------------------
@@TJvAppIniStorage.DefaultSection
Summary
  Write here a summary (1 line)
Description
  Write here a description
See Also
  List here other properties, methods (comma seperated)
  Remove the 'See Also' section if there are no references
----------------------------------------------------------------------------------------------------
@@TJvAppIniStorage.ReadValue
Summary
  Retrieves a value.
Description
  ReadValue retrieves a value in string format from the INI based storage.
Parameters
  Section - Section of the value to read.
  Key     - Key of the value to read.
See Also
  RemoveValue, WriteValue
----------------------------------------------------------------------------------------------------
@@TJvAppIniStorage.RemoveValue
Summary
  Deletes a value.
Description
  RemoveValue deletes a value for the INI based storage.
Parameters
  Section - Section of the value to remove.
  Key     - Key of the value to remove.
See Also
  ReadValue, WriteValue
----------------------------------------------------------------------------------------------------
@@TJvAppIniStorage.ValueExists
Summary
  Determines if a value exists.
Description
  ValueExists determines if the specified value exists. If the Section and Key combination is found
  valueExists returns True, otherwise False is returned.
Parameters
  Section - Section of the value to check.
  Key     - Key of the value to check.
----------------------------------------------------------------------------------------------------
@@TJvAppIniStorage.WriteValue
Summary
  Stores a value.
Description
  WriteValue stores a value in string format in the INI based storage.
Parameters
  Section - Section of the value to write.
  Key     - Key of the value to write.
See Also
  ReadValue, RemoveValue
----------------------------------------------------------------------------------------------------
@@TJvCustomAppIniMemoryStorage
Summary
  Abstract base class for application data storage in INI-file format in a string list.
Description
  TJvCustomAppIniMemoryStorage is the abstract base class for application storage in INI-file format
  in a string list. The base class implements the TJvAppIniStorage methods to use a string list as
  it's storage.

  As a descendant of TJvCustomAppStorage, it provides in the standard interface for storing data (such
  as settings, form positions and sizes, etc). This data will be converted to be usable in an
  INI-file like manner.

  The component introduces a new property to refer to the <LINK Strings, string list>.
----------------------------------------------------------------------------------------------------
@@TJvCustomAppIniMemoryStorage.IsInternalChange
Summary
  Flags if the change in the string list is from one of the internal methods.
Description
  IsInternalChange flags is the change in the string list if from one of the internal methods.

  If set to True the <LINK TStringList.OnChange, OnChange> event handler for the string list is
  triggered due to a change using one of the access methods of the storage. In this case the lookup
  list of sections and their index is untouched, as it is assumed this will be handled by the
  access methods of the storage.

  If set to False the <LINK TStringList.OnChange, OnChange> event handler for the string list is
  triggered because the string list is manipulated directly. In this case the lookup list of
  sections and their index is completely rebuild.
----------------------------------------------------------------------------------------------------
@@TJvCustomAppIniMemoryStorage.Strings
Summary
  String list containing an image of the storage in INI-file format.
Description
  Strings contains a string list containing an image of the storage in INI-file format. It's
  primary reason is to have a way to load and save the storage to a more permanent storage (e.g. to
  a memo field in a database, but a file is also possible).
